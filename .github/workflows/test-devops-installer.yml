name: Test DevOps Installer

on:
  push:
    branches:
      - main
  pull_request:

jobs:
  test-macos:
    runs-on: macos-latest
    steps:
      - name: Checkout repository
        uses: actions/checkout@v4

      - name: Install Homebrew (–µ—Å–ª–∏ –≤–¥—Ä—É–≥ –Ω–µ—Ç)
        run: |
          if ! command -v brew &>/dev/null; then
            /bin/bash -c "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/HEAD/install.sh)"
          fi

      - name: Install gum
        run: brew install charmbracelet/tap/gum

      - name: Run DevOps Installer
        run: |
          chmod +x setup-devops-gui.sh
          ./setup-devops-gui.sh

      - name: Verify installed tools
        run: |
          TOOLS=(
            "git"
            "zsh"
            "fzf"
            "jq"
            "bat"
            "tree"
            "docker"
            "docker-compose"
            "kubectl"
            "helm"
            "k9s"
            "minikube"
            "terraform"
            "aws"
            "gcloud"
            "az"
            "gh"
            "glab"
            "pipx"
            "ansible"
            "visual-studio-code"
            "iterm2"
            "act"
            "tailscale"
            "ngrok"
            "direnv"
            "zoxide"
            "httpie"
            "cheat"
            "btop"
          )

          for tool in "${TOOLS[@]}"; do
            if ! command -v "$tool" &>/dev/null; then
              echo "‚ùå $tool –ù–ï –£–°–¢–ê–ù–û–í–õ–ï–ù!"
              exit 1
            else
              echo "‚úÖ $tool —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω"
            fi
          done

      - name: Success
        run: echo "üéâ –í—Å–µ DevOps-–∏–Ω—Å—Ç—Ä—É–º–µ–Ω—Ç—ã —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω—ã!"
